Module Topics

    Attaching Systems to Subscriptions

    Managing Software Updates

    yum Command Summary

    Enabling yum Repositories


Attaching Systems to Subscriptions
Red Hat Subscription Management

    Provides tools to entitle machines to product subscriptions

        Update software packages

        Track information about support contracts and subscriptions

    PackageKit and yum obtain software packages and updates from Red Hat content distribution network



Register
    
Associate system with Red Hat account to allow Subscription Manager to inventory system


Subscribe

Entitle system to updates for Red Hat products

    Subscriptions have specific support levels, expiration dates, and default repositories

    Tools can auto-attach or select specific entitlement

    As needs change, subscriptions can be removed


Enable repositories

 Provide software packages from repositories

    Multiple repositories are enabled by default

    Other repositories can be enabled or disabled as needed


Review and track
    
Track which entitlements are available or consumed

    Can view information locally on specific system or for account

    Can use Red Hat Customer Portal Subscriptions page or Subscription Asset Manager (SAM)


Registering a System

    From main GNOME menu, select Applications → Other → Red Hat Subscription Manager to launch subscription-manager-gui.

    Enter root password.

    Click Register.

The default subscription.rhn.redhat.com registers the server to Red Hat’s hosted content distribution network.

    Click Next

Authenticate using the Red Hat account to which the system should register.

If more than one subscription is available, or if a specific subscription is required, select Manually attach subscriptions after registration.

Click Register.



Assigning Subscriptions

    Navigate to All Available Subscriptions tab.

    Click Update.

    Select subscriptions to assign and click Attach.

If there are multiple contracts, select the virtual or physical contract to use, and click Attach.

Working With Subscriptions

    To automatically attach system to best subscriptions (without a graphical environment), use subscription-manager

    To register system to Red Hat account:

    [root:server1 ~]# subscription-manager register --username=yourusername --password=yourpassword

    To view available subscriptions:

    [root:server1 ~]# subscription-manager list --available | less

    To auto-attach subscription:

    [root:server1 ~]# subscription-manager attach --auto

    To view consumed subscriptions:

    [root:server1 ~]# subscription-manager list --consumed

    To unregister system:

    [root:server1 ~]# subscription-manager unregister


Activation Keys

    Allow register and assign predefined subscriptions without username or password

    Useful for automated installations and deployments

    Usually issued by on-premise subscription management service


Entitlement Certificates

    Entitlement is a subscription attached to a system

    Stored in digital certificates in /etc/pki and its subdirectories

        /etc/pki/product contains certificates of installed Red Hat products

        /etc/pki/consumer contains certificates that indicate Red Hat account to which system is registered

        /etc/pki/entitlement contains certificates that indicate which subscriptions are attached to system

    Can inspect certificates directly with rct

        subscription-manager is more user-friendly

Subscription Management Versions

    Older versions of Red Hat Enterprise Linux use RHN Classic for subscription management

        RHN Classic not supported by Red Hat Enterprise Linux 7

    Red Hat Subscription Management is only method used by version 7

        For version 6, is default method after 6.3

        For version 5, is default method after 5.9

    Red Hat Enterprise Linux 4 supports only old method

    

For more info, see:

    The subscription-manager-gui(8), subscription-manager(8), and rct(8) man pages.

    Get Started with Red Hat Subscription Management at https://access.redhat.com/site/articles/433903.

    Red Hat Subscription Management, "Migrating from RHN and Satellite," at https://access.redhat.com/site/documentation/en-US/.


Managing Software Updates
Working With yum

    yum: Command-line tool used to install, update, remove, and query software packages

    Download official packages from Red Hat’s content distribution network

    Registering system to subscription management service automatically configures access to software repositories based on attached subscriptions

Listing Available Packages

    To display usage information, use yum help

    To display installed and available packages, use yum list

    [root@server1 ~]# yum list 'http*'


Searching for Available Packages

    To list packages by keywords in name and summary fields, use yum search KEYWORD

    To search for packages by name, summary, and description fields, use search all

    Example: Search for packages with web server in name, summary or description

    [root@server1 ~]# yum search all 'web server'

Viewing Package Information

    To get detailed information about a package, including disk space requirements, use yum info PACKAGENAME

    Example: Get info on Apache HTTP Server

    [root@server1 ~]# yum info httpd

Searching for Packages by Pathname

    To display packages with specified pathname, use yum provides PATHNAME

        Path can include wildcard characters

    Example: Find packages that provide /var/www/html

    [root@server1 ~]# yum provides /var/www/html

Installing Packages

    To obtain and install software package, including any dependencies, use yum install PACKAGENAME

    [root@server1 ~]# yum install httpd

Updating Packages and Kernels

    To obtain and install software package update, including dependencies, use yum update PACKAGENAME

        Process tries to preserve configuration files

        Renames files if packager thinks old name will not work after update

        If PACKAGENAME is not specified, yum update installs all relevant updates

        [root@server1 ~]# yum update

    To install new kernel, use yum update kernel

    Configuration files contain list of packages to always install, even if only update is requested


Viewing Kernel Information

    To list all installed and available kernels, use yum list kernel

    To view currently running kernel, use uname

        To show only kernel version and release, use -r

        To show kernel release and additional information, use -a

        [root@server1 ~]# yum list kernel

Removing Packages

    To remove installed software package, including supported packages, use yum remove PACKAGENAME

    [root@server1 ~]# yum remove httpd

    

    yum remove removes:

        Package listed

        Packages that require package being removed

        Packages that require those packages, and so on

    Can lead to packages being removed unexpectedly

    Carefully check list of packages to be removed!


yum Groups

    Collections of related software installed for a particular purpose

        Regular: Collections of packages

        Environment: Collections of groups that include their own packages

    Types of packages or groups provided by a group:

        Mandatory: Must be installed if group is installed

        Default: Normally installed if group is installed

        Optional: Not installed unless asked for

Listing Groups

    To show names of installed and available groups, use yum group list or yum grouplist

    Some groups installed through environment groups are hidden by default

        To list hidden groups, use yum group list hidden

        To see group ID, use ids

    Can install, update, remove, and query groups by name or ID

    [root@server1 ~]# yum group list

Group Markers

    To display information about a group, use yum group info or yum groupinfo

    Group information includes list of mandatory, default, and optional package names or group IDs

    Package names and group IDs may have marker in front of them:
= 
    Package is installed, was installed as part of group

+ 
     Package isn’t installed, will be if group is installed or updated

-
    Package isn’t installed, will not be if group is installed or updated

No marker    

    Package is installed, but was not installed through group


[root@server1 ~]# yum group info "Identity Management Server"

Installing yum Groups

    To install group, its mandatory and default packages, and packages they depend on, use yum group install or yum groupinstall

    [root@server1 ~]# yum group install "Infiniband Support"


Group Behavior

    Groups are treated as objects and tracked by system

    If installed group is updated, and new mandatory or default packages are added, new packages are installed on update

    Group considered installed only if yum group install installed it

    To mark group installed, use`yum group mark install GROUPNAME`

        Missing packages and dependencies installed on next update

    Two-word command form new in Red Hat Enterprise Linux 7

Viewing Transaction History

    All install and remove transactions are logged in /var/log/yum.log

    [root@server1 ~]# tail -5 /var/log/yum.log

To view transaction summary, use yum history

[root@server1 ~]# yum history

To reverse transaction, use history undo

[root@server1 ~]# yum history undo 6

yum list
    List installed and available packages by name

yum grouplist
    List installed and available groups

yum search KEYWORD
    Search for package by keyword

yum info PACKAGENAME
    Show package details

yum install PACKAGENAME
    Install package

yum groupinstall GROUPNAME
    Install package group

yum history
    Display transaction history

For more info, see:

    yum(1) and yum.conf(5) man pages

    Red Hat Enterprise Linux System Administrator’s Guide for Red Hat Enterprise Linux 7 at http://docs.redhat.com/

Registering system to subscription management service automatically configures access to repositories based on attached subscriptions

To view available repositories:
[root@server1 ~]# yum repolist all

To enable and disable repositories, use yum-config-manager

    Changes enabled parameter in /etc/yum.repos.d/redhat.repo

    [root@server1 ~]# yum-config-manager --enable rhel-7-public-beta-debug-rpms

Third-Party Repositories

    Directories of software packages provided by non-Red Hat sources

    Can be accessed by yum from website, FTP server, or local file system

    To enable support for third-party repositories, put file in /etc/yum.repos.d/

    Configuration file must end in .repo

    Repository definition contains:

        URL of repository

        Name

        Whether to use GPG to check package signatures

            URL pointing to trusted GPG key (if using GPG)


Using yum-config-manager

    To create configuration file for yum repository with known URL, use yum-config-manager

        Creates file in /etc/yum.repos.d:

        [root@server1 ~]# yum-config-manager --add-repo="http://dl.fedoraproject.org/pub/epel/beta/7/x86_64/"
Can modify file to customize name and location of GPG key

Enabling yum Repositories

    Download key to local file

    Do not allow yum to retrieve key from external source

     [EPEL]
    name=EPEL 7 Beta
    baseurl=http://dl.fedoraproject.org/pub/epel/beta/7/x86_64/
    enabled=1
    gpgcheck=1
    gpgkey=file://etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7

RPM Configuration Package

    Some repositories provide RPM configuration file and GPG public key as part of RPM package

        Example: Volunteer project EPEL (Extra Packages for Enterprise Linux)

        EPEL provides software not supported by Red Hat but compatible with Red Hat Enterprise Linux

    To install Red Hat Enterprise Linux 7 EPEL repo package:

    [root@server1 ~]# rpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7
    [root@server1 ~]# yum install http://dl.fedoraproject.org/pub/epel/beta/7/x86_64/epel-release-7-0.1.noarch.rpm

    To define a repository that is not searched by default, use enabled=0

    Repositories can be enabled and disabled:

        Persistently with yum-config-manager

        Temporarily with --enablerepo=PATTERN and --disablerepo=PATTERN

    Install RPM GPG key before installing signed packages

        Verifies packages belong to imported key

        yum complains about missing key

    To ignore missing GPG keys, use --nogpgcheck

        Can cause forged or insecure packages to be installed

For more info, see:

    Red Hat Enterprise Linux System Administrator’s Guide for Red Hat Enterprise Linux 7, section on configuring yum and yum repositories, at http://docs.redhat.com/.

    yum(1), yum.conf(5), and yum-config-manager(1) man pages



