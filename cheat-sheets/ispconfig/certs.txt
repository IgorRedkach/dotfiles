
Install letsencrypt
cd ~
git clone https://github.com/letsencrypt/letsencrypt
cd letsencrypt

service apache2 stop

Create SSL Certificate

./letsencrypt-auto certonly

certbot-auto renew

Use next 4 commands if you are creating a SSL certificate for your ISPConfig Dashboard panel
Backup original ISPConfig certificates

mkdir /usr/local/ispconfig/interface/ssl/originals
mv /usr/local/ispconfig/interface/ssl/isp* /usr/local/ispconfig/interface/ssl/originals/

ln -s /etc/letsencrypt/live/rafikihost.co.ke/fullchain.pem /usr/local/ispconfig/interface/ssl/ispserver.crt
ln -s /etc/letsencrypt/live/rafikihost.co.ke/privkey.pem /usr/local/ispconfig/interface/ssl/ispserver.key

ln -s /etc/letsencrypt/live/www.rafikihost.co.ke/fullchain.pem /usr/local/ispconfig/interface/ssl/ispserver.crt
ln -s /etc/letsencrypt/live/www.rafikihost.co.ke/privkey.pem /usr/local/ispconfig/interface/ssl/ispserver.key

B) If you are creating a SSL certificate for one of your websites...

ls /etc/letsencrypt/live/__DOMAIN__/

and copy/paste the contents of the certificates into the fields (found in the SSL tab) in ISPConfig.

Now go the the SSL tab. We need to copy the obtained certificates and keys to these fields:

And always fire up Apache again ;-)

service apache2 graceful

SSL Key: privkey.pem
Execute cat /etc/letsencrypt/live/wowdoge.com/privkey.pem  and copy the contents to the field in ISPConfig.

SSL Certificate: cert.pem
Execute cat etc/letsencrypt/live/wowdoge.com/cert.pem  and copy the contents to the field in ISPConfig.

SSL Bundle: chain.pem
Execute cat /etc/letsencrypt/live/wowdoge.com/chain.pem  and copy the contents to the field in ISPConfig.

Adding SSL certificates and keysImportant: Select SSL Action ‘Save Certificate’


Redirect http to https

RewriteEngine on
RewriteCond %{SERVER_PORT} !^443$
RewriteRule ^.*$ https://%{SERVER_NAME}%{REQUEST_URI} [L,R=301]


cert.pem: server certificate only.
chain.pem: root and intermediate certificates only.
fullchain.pem: combination of server, root and intermediate certificates (replaces cert.pem and chain.pem).
privkey.pem: private key (do not share this with anyone!)



Maintenance
Renew SSL Certificates

Execute the command you used in Step 1 of the Create an SSL Certificate section, adding the --renew-by-default parameter:

sudo -H ./letsencrypt-auto certonly --standalone --renew-by-default -d example.com -d www.example.com

Automatically Renew SSL Certificates (Optional)
Before we execute the following command, let’s break it down and make some modifications:

echo '@monthly root /opt/letsencrypt/letsencrypt-auto certonly --standalone --renew-by-default -d example.com -d www.example.com >> /var/log/letsencrypt/letsencrypt-auto-update.log' | sudo tee --append /etc/crontab



    @monthly: for simplicity, this command will execute at midnight on the first day of every month
    root: run the command as the root user
    /opt/letsencrypt/letsencrypt-auto certonly –standalone –renew-by-default -d example.com -d www.example.com: letsencrypt-auto renewal command. Again, add -d example.com for each domain name you need to renew
    » /var/log/letsencrypt/letsencrypt-auto-update.log: record the standard output and standard error to a log file named letsencrypt-auto-update.log
    tee –append /etc/crontab: save the new cron job to the /etc/crontab file





 - Congratulations! Your certificate and chain have been saved at
   /etc/letsencrypt/live/rafikihost.co.ke/fullchain.pem. Your cert
   will expire on 2017-03-04. To obtain a new or tweaked version of
   this certificate in the future, simply run certbot-auto again with
   the "certonly" option. To non-interactively renew *all* of your
   certificates, run "certbot-auto renew"
 - If you lose your account credentials, you can recover through
   e-mails sent to admin@rafikihost.co.ke.
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le

