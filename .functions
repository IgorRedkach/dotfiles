#!/bin/bash

# Backup important files to Dropbox

# Shuffle files on mpv
play (){
    mpv --shuffle *
    }


# Check system total boot time
st () {
systemd-analyze | awk '{print $NF}'
}


# Make a temporary directory and enter it
tmpd() {
	if [ $# -eq 0 ]; then
		tmpdir=`mktemp -d` && cd $dir
	else
		dir=`mktemp -d -t $1.XXXXXXXXXX` && cd $tmpdir
	fi
    }




# Package management
 sysbackup () {
     sudo rsync -aAXv --delete  --exclude-from=/etc/rsync_exclude.lst / /mnt/backup/    
     echo ""
     if [[ $? -eq 0 ]]; then
         echo ""
         echo "Backup sync successful"
     else
         echo " Sync failed"
         exit 1
     fi
 }

# Vm management
# start vm management daemons
vm () {
    sudo systemctl start libvirtd.service
    sudo systemctl start vsftpd.service
    sudo systemctl start virtlogd.socket
}

# stop libvirt daemon and vsftpd services
vmstop () {
    sudo systemctl stop libvirtd.service 
    sudo systemctl stop vsftpd.service
}

# Stop all vms running
novm () {
	for i in `sudo virsh list | grep running | awk '{print $2}'`
	do
		sudo virsh shutdown $i
	done                                                                          
}

# List all kvm vms
vmlist () {
	sudo virsh list --all
}

# start rhev vms
rhev () { 
	sudo virsh start node1
	sudo virsh start rhevm
}

# Use wget to download complete site for offline reading

offline () {
    URL="$1"
    DIR="$2"
    # Check if url is given
    if [  -z "$1" ]; then
        echo "Usage : "$0" <url> <directory>"
        echo "If no directory is provided, default is ~/websites"
        exit 0
    else
        echo ""
        echo "*** Downloading "${URL}" content to "{$DIR}"..."
        cd "$DIR"
        sleep 2
        wget --limit-rate=2000k --no-clobber --convert-links --random-wait -r -p -E -e robots=off -U mozilla "$URL" & tail -f nohup.out
    fi

    }

    cleantor () {
        locate "*.torrent.added" | xargs -I {} rm -rf {} 
    }

remtor () {
    locate torrent.added | xargs -I {} rm -rf {}
}
